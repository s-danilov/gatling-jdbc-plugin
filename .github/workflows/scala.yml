name: Scala CI

on:
  push:
    branches:
     - master
     - s-danilov-patch-1

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Set up JDK 11
      uses: actions/setup-java@v1
      with:
        java-version: 11

    - name: Run tests
      run: sbt compile test

    - name: Import GPG key
      id: import_gpg
      uses: crazy-max/ghaction-import-gpg@v3
      with:
        gpg-private-key: ${{ secrets.gpg_private_key }}
        passphrase: ${{ secrets.gpg_passphrase }}

    - name: Publish SBT
      run: sbt publish
      env:
        NEXUS_USER: ${{ secrets.NEXUS_USER }}
        NEXUS_PASS: ${{ secrets.NEXUS_PASS }}
        gatling_jdbc_plugin: ${{ secrets.gatling_jdbc_plugin }}
